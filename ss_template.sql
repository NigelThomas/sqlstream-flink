SELECT STREAM s.ROWTIME, *
     , SUM(RPS) OVER RW / COUNT(RPS) OVER RW AS "Rps30sec"
FROM STREAM(DATA_RATE_RPS(CURSOR (SELECT STREAM * FROM EDR.viewname))) s
WINDOW RW AS (ROWS 30 PRECEDING)
